
document.addEventListener(
	"DOMContentLoaded", () => {
		let toggleMobileSubmenu = function () {
	// Если есть хоть один элемент
	if (document.querySelector('.nav__link--down')) {
		// if (document.documentElement.clientWidth <= 1200) {

		// Если мобильный режим
		if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i.test(navigator.userAgent)) {
			//Выбираем все нужные ссылки
			let navLinksDown = document.querySelectorAll('.nav__link--down');
			navLinksDown.forEach(function(element) {
				// Отслеживаем по ним клик, отменяем стандартное действие
				element.addEventListener('click', function(e) {
					e.preventDefault();
					// navLinksDown.forEach(function(element) {
					// 	element.classList.remove('toggle');
					// 	e.target.classList.toggle('toggle');
					// });

					let parentEl = e.target.parentElement;

					// Задаем нужные классы
					e.target.classList.toggle('toggle');
					parentEl.classList.toggle('toggle');

					if (!e.target.classList.contains('toggle')) {
						e.target.nextElementSibling.classList.add('toggle');
					} else {
						e.target.nextElementSibling.classList.remove('toggle');
					};
				});
			});
		};
	};
};

toggleMobileSubmenu();const headerFixed = () => {
    const header = document.querySelector('.header');
    const heightHeader = header.offsetHeight; // высота хедера
    header.parentElement.style.paddingTop = heightHeader + 'px';
};

headerFixed();
window.addEventListener("resize", headerFixed);let quizInit = function () {
    let labelRadio = 'label-radio';
    let labelCheckbox = 'label-checkbox';

    document.addEventListener('click', function(e) {
        // Переключение checkbox
        if (e.target.closest('.label-checkbox')) {
            e.target.classList.toggle('toggle');
        };

        // Переключение radio
        if (e.target.closest('.label-radio')) {
            if (!e.target.classList.contains('toggle')) {
                let radioName = e.target.closest('.label-radio').firstElementChild.getAttribute('name');
                let elems = document.querySelectorAll(`[name="${radioName}"]`);
                elems.forEach(function(element) {
                    element.parentElement.classList.remove('toggle');
                });
                e.target.classList.add('toggle');
            };

        };
    });

};

quizInit();

const quizSending = function() {
    let quizForm = document.querySelector('.quiz.form');
    if (quizForm) {
        quizForm.addEventListener('submit', function(e) {
            e.preventDefault();
            document.querySelector('.quiz__middle').classList.add('toggle');
            quizForm.reset();
        });
    }
};

quizSending();

// функция будет перемещать блок в указанное место при определенной ширине экрана

let moving = function () {

        const windowWidth = window.innerWidth; // ширина экрана
        // console.log(windowWidth);

        if (windowWidth <= 1200) {
            document.querySelector('.mobile-menu__wrapper').prepend(document.querySelector('.nav__list'));
        } else {
            document.querySelector('.header__nav').append(document.querySelector('.nav__list'));
        };
};

moving();
window.addEventListener('resize', moving);if (document.querySelector('.js-burger')) {

    const btnBurger = document.querySelectorAll('.js-burger');

    // Открыть / закрыть бургер по клику на него
    function btnBurgerToggle(e) {
        e.target.classList.toggle('toggle');
    }

    btnBurger.forEach(element => {
        element.addEventListener("click", btnBurgerToggle);
        // window.addEventListener("resize", btnBurgerToggleClassRemove);
    });
}if (document.querySelector('.jsMobileMenuBtnToggle')) {

    let menuPanelInit = function () {
        const menuBtn = document.querySelector('.jsMobileMenuBtnToggle');
        const menu = document.querySelector('.mobile-menu');
        const body = document.querySelector('body');
        // const menuLink = document.querySelectorAll('.menu-link'); // для  меню по секциям
    
        // Показать / скрыть мобильное меню - toggle
        function menuPanelToggle() {
            if (menuBtn.classList.contains('toggle')) {
                menu.classList.add('toggle');
                body.classList.add('toggle');
            } else {
                menu.classList.remove('toggle');
                body.classList.remove('toggle');
            };
        };
    
        // Определяем высоту мобильного меню и размещаем под шапкой
        function menuPanelPosition() {
            const heightViewport = document.documentElement.clientHeight;
            const heightHeader = document.querySelector('.header').offsetHeight;
            const heightMenuOverlay = heightViewport - heightHeader;
            // let posTop = window.pageYOffset;
            let posTop = window.scrollY;
    
            const menuActive = document.querySelector('.mobile-menu.toggle');
    
            if (menuActive) {
                menuActive.style.height = heightMenuOverlay + 'px';
                menuActive.style.top = posTop + heightHeader + 'px';
            };
        };
    
        // Закрыть мобильное меню
        function menuPanelClose() {
            menuBtn.classList.remove('toggle');
            menu.classList.remove('toggle');
            body.classList.remove('toggle');
        };

        // Закрываем мобильное меню по клику вне его
        function menuPanelOnClickClose() {
            document.addEventListener("click", function(e) {
                const target = e.target;
                const its_menu = target == menu || menu.contains(target);
                const its_btnMenu = target == menuBtn;
    
                if (!its_menu && !its_btnMenu) {
                    menuPanelClose();
                };
            });
        };
    
        // Закрыть мобильное меню при resize
        window.addEventListener('resize', function () {
            menuPanelClose();
        }, true);
    
        // Закрываем меню (для меню по секциям)
        // menuLink.forEach(element => {
        //     element.addEventListener("click", menuPanelClose);
        // });
    
        // Показать / скрыть мобильное меню
        let menuLaunch = function() {
            menuPanelToggle();
            menuPanelPosition();
            menuPanelOnClickClose();
        };

        menuBtn.addEventListener("click", menuLaunch);
    };

    menuPanelInit();

};// Инициализация Inputmask
// https://github.com/RobinHerbots/Inputmask

function initInputMask() {
	let formPhone = document.querySelectorAll('.form__phone');
	formPhone.forEach(element => {
		Inputmask({ "mask": "+7 (999) 999-99-99" }).mask(element);
	});
}

initInputMask();// Инициализация слайдера swiper
// https://swiperjs.com/

function initSwiper() {
	if (document.querySelector(".b08-slider-js")) {
		const b08SliderJs = new Swiper(".b08-slider-js", {
			slidesPerView: "auto",
			spaceBetween: 20,
			// loop: true,
			navigation: {
				nextEl: ".b08-slider__next",
				prevEl: ".b08-slider__prev",
			},
		});
	}

	if (document.querySelector(".quiz-slider")) {
		const b04SliderJs = new Swiper(".quiz-slider", {
			slidesPerView: 1,
			spaceBetween: 5,
			allowTouchMove: false,
			loop: false,
			pagination: {
				el: ".quiz-counter",
				type: "fraction",
			},
			navigation: {
				nextEl: ".quiz-btn__next",
				prevEl: ".quiz-btn__prev",
			},
		});

		// Когда достигаем конца слайдера
		b04SliderJs.on("slideChange", function () {
			if (b04SliderJs.isEnd) {
				document.querySelector('.quiz-btn__next').style.display = 'none';
				document.querySelector('.quiz-btn__send').style.display = 'block';
			} else {
				document.querySelector('.quiz-btn__next').style.display = 'block';
				document.querySelector('.quiz-btn__send').style.display = 'none';
			};
		});

	};
};

// window.addEventListener("resize", initSwiper);
window.addEventListener("resize", function () {
	// setTimeout(initSwiper, 200);
	initSwiper();
	// swiper.init();
});

initSwiper();
// -include './myscripts/accordeon.js'
		// -include './myscripts/blazy-init.js'
		// -include './myscripts/preloader.js'
	}
);
